<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ddx: ddx_constants Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ddx<span id="projectnumber">&#160;0.6.8</span>
   </div>
   <div id="projectbrief">Libary for domain-decomposition methods for polarizable continuum models</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceddx__constants.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">ddx_constants Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Run-time constants.  
<a href="namespaceddx__constants.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for precomputed constants.  <a href="structddx__constants_1_1ddx__constants__type.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a6e92b4f30453727bdb2f9ba7b6faae9b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a6e92b4f30453727bdb2f9ba7b6faae9b">constants_init</a> (params, constants, ddx_error)</td></tr>
<tr class="memdesc:a6e92b4f30453727bdb2f9ba7b6faae9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute all necessary constants.  <a href="namespaceddx__constants.html#a6e92b4f30453727bdb2f9ba7b6faae9b">More...</a><br /></td></tr>
<tr class="separator:a6e92b4f30453727bdb2f9ba7b6faae9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23c5f32bf10f2cef9efb98249d23af15"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a23c5f32bf10f2cef9efb98249d23af15">build_itrnl</a> (constants, params, ddx_error)</td></tr>
<tr class="memdesc:a23c5f32bf10f2cef9efb98249d23af15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the transposed neighbor list.  <a href="namespaceddx__constants.html#a23c5f32bf10f2cef9efb98249d23af15">More...</a><br /></td></tr>
<tr class="separator:a23c5f32bf10f2cef9efb98249d23af15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bc82a98de791c899b8a5853d26048fa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a4bc82a98de791c899b8a5853d26048fa">build_l</a> (constants, params, ddx_error)</td></tr>
<tr class="memdesc:a4bc82a98de791c899b8a5853d26048fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and build the ddCOSMO sparse matrix, only if incore is set.  <a href="namespaceddx__constants.html#a4bc82a98de791c899b8a5853d26048fa">More...</a><br /></td></tr>
<tr class="separator:a4bc82a98de791c899b8a5853d26048fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c17b7de5b75b3123c33fb48da2017d2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a2c17b7de5b75b3123c33fb48da2017d2">build_b</a> (constants, params, ddx_error)</td></tr>
<tr class="memdesc:a2c17b7de5b75b3123c33fb48da2017d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and build the HSP sparse matrix, only if incore is set.  <a href="namespaceddx__constants.html#a2c17b7de5b75b3123c33fb48da2017d2">More...</a><br /></td></tr>
<tr class="separator:a2c17b7de5b75b3123c33fb48da2017d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5826bc847008b2eb36949c6b05b3e5d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#af5826bc847008b2eb36949c6b05b3e5d">mkpmat</a> (params, constants, isph, pmat)</td></tr>
<tr class="memdesc:af5826bc847008b2eb36949c6b05b3e5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computation of P_chi.  <a href="namespaceddx__constants.html#af5826bc847008b2eb36949c6b05b3e5d">More...</a><br /></td></tr>
<tr class="separator:af5826bc847008b2eb36949c6b05b3e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94adb04b3b8d45127c71d5b60d9de6f1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a94adb04b3b8d45127c71d5b60d9de6f1">constants_geometry_init</a> (params, constants, ddx_error)</td></tr>
<tr class="memdesc:a94adb04b3b8d45127c71d5b60d9de6f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize geometry-related constants like list of neighbouring spheres.  <a href="namespaceddx__constants.html#a94adb04b3b8d45127c71d5b60d9de6f1">More...</a><br /></td></tr>
<tr class="separator:a94adb04b3b8d45127c71d5b60d9de6f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f00ff09bdd03bfcb77c12678b088aac"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a3f00ff09bdd03bfcb77c12678b088aac">neighbor_list_init</a> (params, constants, ddx_error)</td></tr>
<tr class="memdesc:a3f00ff09bdd03bfcb77c12678b088aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the neighbor list using a N^2 code.  <a href="namespaceddx__constants.html#a3f00ff09bdd03bfcb77c12678b088aac">More...</a><br /></td></tr>
<tr class="separator:a3f00ff09bdd03bfcb77c12678b088aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75e67c88896a03e0463dbc1518b3ace9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a75e67c88896a03e0463dbc1518b3ace9">neighbor_list_init_fmm</a> (params, constants, ddx_error)</td></tr>
<tr class="memdesc:a75e67c88896a03e0463dbc1518b3ace9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the neighbor list using a linear scaling code (only if FMMs are enabled)  <a href="namespaceddx__constants.html#a75e67c88896a03e0463dbc1518b3ace9">More...</a><br /></td></tr>
<tr class="separator:a75e67c88896a03e0463dbc1518b3ace9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb0c060445e3b2d40b770eda26d20fdb"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#abb0c060445e3b2d40b770eda26d20fdb">fsw</a> (t, se, eta)</td></tr>
<tr class="memdesc:abb0c060445e3b2d40b770eda26d20fdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switching function.  <a href="namespaceddx__constants.html#abb0c060445e3b2d40b770eda26d20fdb">More...</a><br /></td></tr>
<tr class="separator:abb0c060445e3b2d40b770eda26d20fdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66fd73de84672f0f78f4c9c4e2c620b5"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a66fd73de84672f0f78f4c9c4e2c620b5">dfsw</a> (t, se, eta)</td></tr>
<tr class="memdesc:a66fd73de84672f0f78f4c9c4e2c620b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative of a switching function.  <a href="namespaceddx__constants.html#a66fd73de84672f0f78f4c9c4e2c620b5">More...</a><br /></td></tr>
<tr class="separator:a66fd73de84672f0f78f4c9c4e2c620b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42e14753989ec5f572237370884dc57e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a42e14753989ec5f572237370884dc57e">mkprec</a> (lmax, nbasis, nsph, ngrid, eps, ui, wgrid, vgrid, vgrid_nbasis, rx_prc, ddx_error)</td></tr>
<tr class="memdesc:a42e14753989ec5f572237370884dc57e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute preconditioner assemble the diagonal blocks of the reps matrix then invert them to build the preconditioner.  <a href="namespaceddx__constants.html#a42e14753989ec5f572237370884dc57e">More...</a><br /></td></tr>
<tr class="separator:a42e14753989ec5f572237370884dc57e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5425f991454fc8f92fd24f1577212a4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#ab5425f991454fc8f92fd24f1577212a4">tree_rib_build</a> (nsph, csph, rsph, order, cluster, children, parent, cnode, rnode, snode, ddx_error)</td></tr>
<tr class="memdesc:ab5425f991454fc8f92fd24f1577212a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a recursive inertial binary tree.  <a href="namespaceddx__constants.html#ab5425f991454fc8f92fd24f1577212a4">More...</a><br /></td></tr>
<tr class="separator:ab5425f991454fc8f92fd24f1577212a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7f84bf2e8fe2a577dfbc403fb174c8a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#ad7f84bf2e8fe2a577dfbc403fb174c8a">tree_rib_node_bisect</a> (nsph, csph, n, order, div, ddx_error)</td></tr>
<tr class="memdesc:ad7f84bf2e8fe2a577dfbc403fb174c8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divide given cluster of spheres into two subclusters by inertial bisection.  <a href="namespaceddx__constants.html#ad7f84bf2e8fe2a577dfbc403fb174c8a">More...</a><br /></td></tr>
<tr class="separator:ad7f84bf2e8fe2a577dfbc403fb174c8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e9f0301398a1007b912f94c7239dffd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a3e9f0301398a1007b912f94c7239dffd">tree_get_farnear_work</a> (n, children, cnode, rnode, lwork, iwork, jwork, work, nnfar, nfar, nnnear, nnear)</td></tr>
<tr class="memdesc:a3e9f0301398a1007b912f94c7239dffd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find near and far admissible pairs of tree nodes and store it in work array.  <a href="namespaceddx__constants.html#a3e9f0301398a1007b912f94c7239dffd">More...</a><br /></td></tr>
<tr class="separator:a3e9f0301398a1007b912f94c7239dffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4961d4e2731a6ade2dd395d00a87d9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#afa4961d4e2731a6ade2dd395d00a87d9">tree_get_farnear</a> (jwork, lwork, work, n, nnfar, nfar, sfar, far, nnnear, nnear, snear, near)</td></tr>
<tr class="memdesc:afa4961d4e2731a6ade2dd395d00a87d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get near and far admissible pairs from work array of tree_get_farnear_work Works only for binary tree.  <a href="namespaceddx__constants.html#afa4961d4e2731a6ade2dd395d00a87d9">More...</a><br /></td></tr>
<tr class="separator:afa4961d4e2731a6ade2dd395d00a87d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97df3171ca5347f984551fe3a1bc7ed2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceddx__constants.html#a97df3171ca5347f984551fe3a1bc7ed2">constants_free</a> (constants, ddx_error)</td></tr>
<tr class="memdesc:a97df3171ca5347f984551fe3a1bc7ed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate the constants.  <a href="namespaceddx__constants.html#a97df3171ca5347f984551fe3a1bc7ed2">More...</a><br /></td></tr>
<tr class="separator:a97df3171ca5347f984551fe3a1bc7ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Run-time constants. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a6e92b4f30453727bdb2f9ba7b6faae9b" name="a6e92b4f30453727bdb2f9ba7b6faae9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e92b4f30453727bdb2f9ba7b6faae9b">&#9670;&nbsp;</a></span>constants_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::constants_init </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__parameters_1_1ddx__params__type.html">ddx_params_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(out)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute all necessary constants. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">params</td><td>Object containing all inputs. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">constants</td><td>Object containing all constants. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ddx_error</td><td>ddX error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l00236">236</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a23c5f32bf10f2cef9efb98249d23af15" name="a23c5f32bf10f2cef9efb98249d23af15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23c5f32bf10f2cef9efb98249d23af15">&#9670;&nbsp;</a></span>build_itrnl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::build_itrnl </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__parameters_1_1ddx__params__type.html">ddx_params_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the transposed neighbor list. </p>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l00555">555</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a4bc82a98de791c899b8a5853d26048fa" name="a4bc82a98de791c899b8a5853d26048fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bc82a98de791c899b8a5853d26048fa">&#9670;&nbsp;</a></span>build_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::build_l </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__parameters_1_1ddx__params__type.html">ddx_params_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate and build the ddCOSMO sparse matrix, only if incore is set. </p>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l00580">580</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a2c17b7de5b75b3123c33fb48da2017d2" name="a2c17b7de5b75b3123c33fb48da2017d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c17b7de5b75b3123c33fb48da2017d2">&#9670;&nbsp;</a></span>build_b()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::build_b </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__parameters_1_1ddx__params__type.html">ddx_params_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate and build the HSP sparse matrix, only if incore is set. </p>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l00652">652</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="af5826bc847008b2eb36949c6b05b3e5d" name="af5826bc847008b2eb36949c6b05b3e5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5826bc847008b2eb36949c6b05b3e5d">&#9670;&nbsp;</a></span>mkpmat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::mkpmat </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__parameters_1_1ddx__params__type.html">ddx_params_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(constants % nbasis, constants % nbasis0), intent(inout)&#160;</td>
          <td class="paramname"><em>pmat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computation of P_chi. </p>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l00731">731</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a94adb04b3b8d45127c71d5b60d9de6f1" name="a94adb04b3b8d45127c71d5b60d9de6f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94adb04b3b8d45127c71d5b60d9de6f1">&#9670;&nbsp;</a></span>constants_geometry_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::constants_geometry_init </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__parameters_1_1ddx__params__type.html">ddx_params_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize geometry-related constants like list of neighbouring spheres. </p>
<p >This routine does not check ddx_error state of params or constants as it is intended for a low-level use.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">params</td><td>Object containing all inputs. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">constants</td><td>Object containing all constants. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ddx_error</td><td>ddX error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l00767">767</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a3f00ff09bdd03bfcb77c12678b088aac" name="a3f00ff09bdd03bfcb77c12678b088aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f00ff09bdd03bfcb77c12678b088aac">&#9670;&nbsp;</a></span>neighbor_list_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::neighbor_list_init </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__parameters_1_1ddx__params__type.html">ddx_params_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the neighbor list using a N^2 code. </p>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01074">1074</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a75e67c88896a03e0463dbc1518b3ace9" name="a75e67c88896a03e0463dbc1518b3ace9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75e67c88896a03e0463dbc1518b3ace9">&#9670;&nbsp;</a></span>neighbor_list_init_fmm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::neighbor_list_init_fmm </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__parameters_1_1ddx__params__type.html">ddx_params_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the neighbor list using a linear scaling code (only if FMMs are enabled) </p>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01159">1159</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="abb0c060445e3b2d40b770eda26d20fdb" name="abb0c060445e3b2d40b770eda26d20fdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb0c060445e3b2d40b770eda26d20fdb">&#9670;&nbsp;</a></span>fsw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function ddx_constants::fsw </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>se</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>eta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Switching function. </p>
<p >This is an implementation of \( \chi(t) \) with a shift \( se \): </p><p class="formulaDsp">
\[
      \chi_\eta(t) = \left\{ \begin{array}{ll} 0, &amp; \text{if} \quad x \geq
      1 \\ p_\eta(x), &amp; \text{if} \quad 1-\eta &lt; x &lt; 1 \\ 1, &amp; \text{if}
      \quad x \leq 1-\eta \end{array} \right.
 \]
</p>
<p> where \( x = t - \frac{1+se}{2} \eta \) is a shifted coordinate and </p><p class="formulaDsp">
\[
      p_\eta(x) = \frac{1}{\eta^5} (1-t)^3 (6t^2 + (15\eta-12)t + (10\eta^2
      -15\eta+6))
 \]
</p>
<p> is a smoothing polynomial of the 5th degree. In the case shift \( se=1 \) the switch function \( \chi_\eta(t) \) is 1 for \( t \in [0,1] \), is 0 for \( t \in [1+\eta, \infty) \) and varies in \( [1, 1+\eta] \) which is an external shift. In the case shift \( se=-1 \) the switch function \( \chi_\eta(t) \) is 1 for \( t \in [0,1-\eta] \), is 0 for \( t \in [1, \infty) \) and varies in \( [1-\eta, 1] \) which is an internal shift. In the case shift \( se=0 \) the switch function \( \chi_\eta(t) \) is 1 for \( t \in [0,1-\eta/2] \), is 0 for \( t \in [1+\eta/2, \infty) \) and varies in \( [1-\eta/2, 1+\eta/2] \) which is a centered shift.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>real non-negative input value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">se</td><td>shift </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eta</td><td>regularization parameter \( \eta \) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01276">1276</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a66fd73de84672f0f78f4c9c4e2c620b5" name="a66fd73de84672f0f78f4c9c4e2c620b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66fd73de84672f0f78f4c9c4e2c620b5">&#9670;&nbsp;</a></span>dfsw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function ddx_constants::dfsw </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>se</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>eta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derivative of a switching function. </p>
<p >This is an implementation of \( \chi&#39;(t) \) with a shift \( se \): </p><p class="formulaDsp">
\[
      \chi_\eta&#39;(t) = \left\{ \begin{array}{ll} 0, &amp; \text{if} \quad x \geq
      1 \\ p&#39;_\eta(x), &amp; \text{if} \quad 1-\eta &lt; x &lt; 1 \\ 0, &amp; \text{if}
      \quad x \leq 1-\eta \end{array} \right.
 \]
</p>
<p> where \( x = t - \frac{1+se}{2} \eta \) is a shifted coordinate and </p><p class="formulaDsp">
\[
      p&#39;_\eta(x) = -\frac{30}{\eta^5} (1-t)^2 (t-1+\eta)^2
 \]
</p>
<p> is a derivative of the smoothing polynomial. In the case shift \( se=1 \) the derivative \( \chi_\eta&#39;(t) \) is 0 for \( t \in [0,1] \cup [1+\eta, \infty) \) and varies in \( [1, 1+\eta] \) which is an external shift. In the case shift \( se=-1 \) the derivative \( \chi_\eta&#39;(t) \) is 0 for \( t \in [0,1-\eta] \cup [1, \infty) \) and varies in \( [1-\eta, 1] \) which is an internal shift. In the case shift \( se=0 \) the derivative \( \chi_\eta&#39;(t) \) is 0 for \( t \in [0,1-\eta/2] \cup [1+\eta/2, \infty) \) and varies in \( [1-\eta/2, 1+\eta/2] \) which is a centered shift.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>real non-negative input value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">se</td><td>shift </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eta</td><td>regularization parameter \( \eta \) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01331">1331</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a42e14753989ec5f572237370884dc57e" name="a42e14753989ec5f572237370884dc57e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42e14753989ec5f572237370884dc57e">&#9670;&nbsp;</a></span>mkprec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::mkprec </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ngrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>eps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(ngrid, nsph), intent(in)&#160;</td>
          <td class="paramname"><em>ui</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(ngrid), intent(in)&#160;</td>
          <td class="paramname"><em>wgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(vgrid_nbasis, ngrid), intent(in)&#160;</td>
          <td class="paramname"><em>vgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>vgrid_nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nbasis, nbasis, nsph), intent(out)&#160;</td>
          <td class="paramname"><em>rx_prc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute preconditioner assemble the diagonal blocks of the reps matrix then invert them to build the preconditioner. </p>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01357">1357</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="ab5425f991454fc8f92fd24f1577212a4" name="ab5425f991454fc8f92fd24f1577212a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5425f991454fc8f92fd24f1577212a4">&#9670;&nbsp;</a></span>tree_rib_build()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::tree_rib_build </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(3, nsph), intent(in)&#160;</td>
          <td class="paramname"><em>csph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nsph), intent(in)&#160;</td>
          <td class="paramname"><em>rsph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nsph), intent(out)&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2, 2*nsph-1), intent(out)&#160;</td>
          <td class="paramname"><em>cluster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2, 2*nsph-1), intent(out)&#160;</td>
          <td class="paramname"><em>children</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2*nsph-1), intent(out)&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(3, 2*nsph-1), intent(out)&#160;</td>
          <td class="paramname"><em>cnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(2*nsph-1), intent(out)&#160;</td>
          <td class="paramname"><em>rnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nsph), intent(out)&#160;</td>
          <td class="paramname"><em>snode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build a recursive inertial binary tree. </p>
<p >Uses inertial bisection in a recursive manner until each leaf node has only one input sphere inside. Number of tree nodes is always 2*nsph-1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nsph</td><td>Number of input spheres </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">csph</td><td>Centers of input spheres </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rsph</td><td>Radii of input spheres </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">order</td><td>Ordering of input spheres to make spheres of one cluster contiguous. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cluster</td><td>Indexes in <code>order</code> array of the first and the last spheres of each cluster </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">children</td><td>Indexes of the first and the last children nodes. If both indexes are equal this means there is only 1 child node and if value of the first child node is 0, there are no children nodes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parent</td><td>Parent of each cluster. Value 0 means there is no parent node which corresponds to the root node (with index 1). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cnode</td><td>Center of a bounding sphere of each node </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rnode</td><td>Radius of a bounding sphere of each node </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">snode</td><td>Array of leaf nodes containing input spheres </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ddx_error</td><td>ddX error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01448">1448</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="ad7f84bf2e8fe2a577dfbc403fb174c8a" name="ad7f84bf2e8fe2a577dfbc403fb174c8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7f84bf2e8fe2a577dfbc403fb174c8a">&#9670;&nbsp;</a></span>tree_rib_node_bisect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::tree_rib_node_bisect </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(3, nsph), intent(in)&#160;</td>
          <td class="paramname"><em>csph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>div</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Divide given cluster of spheres into two subclusters by inertial bisection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nsph</td><td>Number of all input spheres </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">csph</td><td>Centers of all input spheres </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of spheres in a given cluster </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">order</td><td>Indexes of spheres in a given cluster. On exit, indexes <code>order(1:div)</code> correspond to the first subcluster and indexes <code>order(div+1:n)</code> correspond to the second subcluster. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">div</td><td>Break point of <code>order</code> array between two clusters. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ddx_error</td><td>ddX error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01575">1575</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a3e9f0301398a1007b912f94c7239dffd" name="a3e9f0301398a1007b912f94c7239dffd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9f0301398a1007b912f94c7239dffd">&#9670;&nbsp;</a></span>tree_get_farnear_work()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::tree_get_farnear_work </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2, n), intent(in)&#160;</td>
          <td class="paramname"><em>children</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(3, n), intent(in)&#160;</td>
          <td class="paramname"><em>cnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>rnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lwork</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>iwork</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>jwork</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3, lwork), intent(inout)&#160;</td>
          <td class="paramname"><em>work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nnfar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>nfar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nnnear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>nnear</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find near and far admissible pairs of tree nodes and store it in work array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">children</td><td>first and last children of each cluster. Value 0 means no children (leaf node). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnode</td><td>center of bounding sphere of each cluster (node) of tree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rnode</td><td>radius of bounding sphere of each cluster (node) of tree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwork</td><td>size of work array in dimension 2 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwork</td><td>index of current pair of nodes that needs to be checked for admissibility. Must be 0 for the first call of this subroutine. If on exit iwork is less or equal to jwork, that means lwork was too small, please reallocate work array and copy all the values into new array and then run procedure again. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jwork</td><td>amount of stored possible admissible pairs of nodes. Please read iwork comments. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">work</td><td>all the far and near pairs will be stored here </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nnfar</td><td>total amount of far admissible pairs. valid only if iwork is greater than jwork on exit. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nfar</td><td>amount of far admissible pairs for each node. valid only if iwork is greater than jwork on exit. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nnnear</td><td>total amount of near admissible pairs. valid only if iwork is greater than jwork on exit </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nnear</td><td>amount of near admissible pairs for each node. valid only if iwork is greater than jwork on exit </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01683">1683</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="afa4961d4e2731a6ade2dd395d00a87d9" name="afa4961d4e2731a6ade2dd395d00a87d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa4961d4e2731a6ade2dd395d00a87d9">&#9670;&nbsp;</a></span>tree_get_farnear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::tree_get_farnear </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jwork</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lwork</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3, lwork), intent(in)&#160;</td>
          <td class="paramname"><em>work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nnfar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>nfar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n+1), intent(out)&#160;</td>
          <td class="paramname"><em>sfar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nnfar), intent(out)&#160;</td>
          <td class="paramname"><em>far</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nnnear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>nnear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n+1), intent(out)&#160;</td>
          <td class="paramname"><em>snear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nnnear), intent(out)&#160;</td>
          <td class="paramname"><em>near</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get near and far admissible pairs from work array of tree_get_farnear_work Works only for binary tree. </p>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01776">1776</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
<a id="a97df3171ca5347f984551fe3a1bc7ed2" name="a97df3171ca5347f984551fe3a1bc7ed2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97df3171ca5347f984551fe3a1bc7ed2">&#9670;&nbsp;</a></span>constants_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ddx_constants::constants_free </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structddx__constants_1_1ddx__constants__type.html">ddx_constants_type</a>), intent(out)&#160;</td>
          <td class="paramname"><em>constants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structddx__errors_1_1ddx__error__type.html">ddx_error_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ddx_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate the constants. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">constants</td><td>Precomputed constants </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ddx_error</td><td>ddX error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ddx__constants_8f90_source.html#l01835">1835</a> of file <a class="el" href="ddx__constants_8f90_source.html">ddx_constants.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceddx__constants.html">ddx_constants</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
