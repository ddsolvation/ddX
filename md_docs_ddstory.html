<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ddx: The dd-story</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ddx<span id="projectnumber">&#160;0.6.7</span>
   </div>
   <div id="projectbrief">Libary for domain-decomposition methods for polarizable continuum models</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_ddstory.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The dd-story </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><em>“A quantum chemist, an applied mathematician and a molecular dynamics expert enter in a meeting room…”</em></p>
<h2><a class="anchor" id="autotoc_md29"></a>
A long story short</h2>
<h3><a class="anchor" id="autotoc_md30"></a>
ddCOSMO</h3>
<p >The first aspect that should be apparent in the ddCOSMO story is that this is a multidisciplinary story, involving three different communities: applied mathematicians, quantum chemists and the classical molecular dynamics community. Therefore, the answer to the questions “what was the most rewarding part of the project” and “what was the most difficult part of the project” is unique: working together. The incredible language barrier between mathematicians and chemist has made the communication quite difficult until a common ground was found, and, after quite a few very funny reunions which ended with people looking at each other with a very puzzled face, we finally managed to fully understand each other. This certainly required a big effort from every side, but such an effort was amply rewarded not only by the results, which couldn’t have been obtained without such a collaboration, but also, or even mainly, for the fun we had working together and for the pleasure of collaborating with scientist that do not share the same education and view on problems, but can provide, every day and in every occasion, an exciting and new perspective on old and new problems.</p>
<p >The project has its roots in an awarded France-Berkeley-Fund proposal in 2011 which allowed the collaboration between the applied mathematicians Eric Cancès, Yvon Maday (Paris region) and Benjamin Stamm (UC Berkeley at that time). The initial plan was to use reduced order techniques in solvation models, but, as so often in life, we deviated from the original route and the ddCOSMO was developed. </p>
<p >The chemistry side of this story starts in June 2012. Realizing the potentialities of the algorithm for chemical applications, Eric Cancès contacted Benedetta Mennucci to inquire whether she was interested in the development of the method, and whether she had a student who could work on the implementation and on the interface with the various quantum chemical packages. On Thursday June the 7th, Filippo Lipparini, at the time a Ph.D. student in Prof. Mennucci’s group, attended the first meeting in Paris. It was love at first sight!</p>
<p >A first, preliminary, pedestrian implementation was obtained in the following summer. The iterative solver was a simple Jacobi Solver, Spherical Harmonics – needed for the discretization – were generated using library calls for the trigonometric functions, no vectorization attempt of the code had been made and the stand-alone, Fortran 77 initial code was quite a mess: nevertheless, it was already at least two order of magnitude faster than the traditional COSMO implementations.</p>
<p >A first paper describing the algorithm was submitted to the Journal of Chemical Physics in March 2013. At the same time, the work on a more efficient implementation, and on the implementation of analytical derivatives of the ddCOSMO energy with respect to the nuclei’s positions had started. The results of this work were submitted to the Journal of Chemical Theory and Computation in April 2013. </p>
<p >With the preliminary development of the ddCOSMO machinery completed, the interfacing work started. From the quantum chemistry side, a first implementation was achieved in Gaussian together with Benedetta Mennucci, first for semiempirical methods, then, in collaboration with Giovanni Scalmani, for general Quantum Mechanical models. From the classical side, ddCOSMO was implemented in Tinker for classical force field simulations first and for polarizable force fields later together with Jean-Philip Piquemal.</p>
<p >The results were very encouraging. We compared ddCOSMO to the fastest implementation we knew of – based on the Fast Multipole Method – and obtained a gain of two to three orders of magnitude. The comparison with traditional, quadratic scaling implementations was even more impressive, with elapsed time of several hours being reduced to a few seconds. ddCOSMO proved to be so fast that we considered using it to provide a boundary condition in polarizable molecular dynamics simulation: taking fully into account the mutual polarization between the solvent and the solute, we could carry out MD simulations of medium-sized molecules on a standard computer node.</p>
<p ><b>A funny side note:</b> The first paper describing the algorithm that was submitted to the Journal of Chemical Physics in March 2013 by the three Mathematicians Cancès, Maday and Stamm received a funny review with statements such as: <em>“..., however the manuscript suffers greatly from the reliance on the authors trying to write and act like mathematicians”</em> <em>“There's a useful numerical method here, at the heart of it all, but the presentation is a convoluted mess …, if it is to be useful to (and understood by) the chemical physics community.”</em> <em>“It's just a 3-d differential equation that they are mapping onto a boundary-element method and solving via domain decomposition. It's not rocket science, it's just linear equations &ndash; so why present the material in a complicated (and tediously long) way?”</em></p>
<h3><a class="anchor" id="autotoc_md31"></a>
ddPCM</h3>
<h3><a class="anchor" id="autotoc_md32"></a>
ddLPB</h3>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
